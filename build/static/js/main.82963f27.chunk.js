(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{147:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(36),i=n.n(c),a=n(34),s=n.n(a),o=n(15),u=n.n(o),d=n(24),j=n(30),l=n(4),f=(n(141),n(19)),b=n(16),h="INVENTORY/CHANGE_MONEY",O="INVENTORY/CHANGE_HOUSE",p="INVENTORY/CHANGE_PEOPLE",v="INVENTORY/CHANGE_ROCKET",x="INVENTORY/CHANGE_FOOD",g="INVENTORY/SET_INVENTORY",m={money:0,house:0,people:0,rocket:0,food:0},y=function(e){return{type:h,change:e}},k=function(e){return{type:O,change:e}},I=function(e){return{type:p,change:e}},E=function(e){return{type:v,change:e}},S=function(e){return{type:x,change:e}},T=function(e,t){var n="";switch(e){case h:n=y;break;case O:n=k;break;case p:n=I;break;case v:n=E;break;case x:n=S}return function(e){e(n(t))}},w=function(e){return{type:g,setInventory:e}},U="USERS/SET_FRIENDS",_="USERS/SET_USER",A="USERS/SET_ACTIVE_USER_PAGE",N="USERS/SET_UNSEEN_INFO",P={user:null,friends:null,activeUserPage:1,unseen:null},C=function(e){return{type:A,id:e}},D=function(e){return{type:N,info:e}},B=n(172),R=n(3),F=Object(f.b)((function(e){return{money:e.myInventory.money,user:e.usersInfo.user}}))((function(e){var t=e.go,n=e.backButton,r=e.headerName,c=e.user,i=e.money;return Object(R.jsxs)(R.Fragment,{children:[n?Object(R.jsx)(l.s,{left:Object(R.jsx)(l.t,{onClick:t,"data-to":n}),children:r}):Object(R.jsx)(l.s,{children:r}),c&&Object(R.jsx)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Your profile"}),children:Object(R.jsx)(l.g,{before:c.photo_200?Object(R.jsx)(l.c,{src:c.photo_200}):null,description:c.city&&c.city.title?c.city.title:"",after:Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center",color:"black"},children:[i,Object(R.jsx)(B.a,{width:30,height:30})]}),children:"".concat(c.first_name," ").concat(c.last_name)})})]})})),z=n(31),M="startTimer",V="timerTime",G={listenUpdateUser:function(e,t){Ge.database().ref(String(e)).on("value",(function(n){var r=n.val();t(r,e)}))},updateUser:function(e,t,n){Ge.database().ref(String(e)).child("inventory").update(Object(z.a)({},t,n))},updateFullUser:function(e,t){Ge.database().ref(String(e)).child("inventory").update(t)},updateEntryTimeBD:function(e,t){Ge.database().ref(String(e)).child("time").child("timer").update({entry:t})},updateTimerDB:function(e,t,n,r){Ge.database().ref(String(e)).child("time").child("timer").child(t).update(Object(z.a)({},n,r))},updateUnseenDefendInfo:function(e){return Object(d.a)(u.a.mark((function t(){var n,r,c,i,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userId,r=e.attackingUser,c=e.sendInfoDefend,i=e.rocketAttack,a=0,t.next=4,G.getServerTime().on("value",(function(e){var t=e.val()||0;a=Date.now()+t}));case 4:Ge.database().ref(String(n)).child("unseenInfo").child("defend").child(String(r)).update({timeAttack:a,attack:i,destroyed:c});case 5:case"end":return t.stop()}}),t)})))()},updateClearUnseen:function(e){Ge.database().ref(String(e)).child("unseenInfo").child("defend").remove()},getTimerDB:function(e){return Ge.database().ref(String(e)).child("time").child("timer").get()},getServerTime:function(){return Ge.database().ref("/.info/serverTimeOffset")},getUserInventory:function(e){return Ge.database().ref(String(e)).child("inventory").get()},getTimeUserBD:function(e){return Ge.database().ref(String(e)).child("time").get()},getUnseenInfo:function(e){return Ge.database().ref(String(e)).child("unseenInfo").get()}},Y="APP/SET_ACTIVE_PANEL",H="APP/SET_ACTIVE_MODAL",K="APP/MODAL_PAGE_DEFENSE_INFO",L={activePanel:"base",activeModal:null,modalWindow:{}},W=function(e){return{type:H,active:e}},q=function(e){return function(t){var n;t((n=e.currentTarget.dataset.to,{type:Y,active:n}))}},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n){if(null==e)return n(W(null)),void G.updateClearUnseen(t);n(W(e))}},Z=Object(f.b)((function(e){return{}}),{go:q})((function(e){var t=e.id,n=e.go;return Object(R.jsxs)(l.r,{id:t,children:[Object(R.jsx)(F,{headerName:"Home"}),Object(R.jsx)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Navigation"}),children:Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",mode:"secondary",onClick:n,"data-to":"base",children:"BASE"})})})]})})),Q=(n.p,n(147),Object(f.b)((function(e){return{}}),{go:q,modalGo:J})((function(e){var t=e.id,n=e.go;e.modalGo;return Object(R.jsxs)(l.r,{id:t,children:[Object(R.jsx)(F,{go:n,headerName:"Base",backButton:"home"}),Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Navigation"}),children:[Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:n,"data-to":"inventory",children:"Inventory"})}),Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:n,"data-to":"friends",children:"Friends"})}),Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:n,"data-to":"actionNavigator",children:"Action"})})]})]})}))),X=n(173),$=n(174),ee=n(175),te=n(176),ne={money:B.a,people:X.a,house:$.a,rocket:ee.a,food:te.a},re=30,ce=30,ie=Object(f.b)((function(e){return{init:e.auth.init,inventory:e.myInventory}}),{go:q})((function(e){var t=e.id,n=e.go,r=e.inventory,c=Object.keys(r).map((function(e){var t=ne[e];return Object(R.jsx)(l.k,{onClick:n,"data-to":e+"Desc",children:Object(R.jsxs)(l.w,{children:[Object(R.jsx)(l.l,{mode:"secondary",children:e}),Object(R.jsxs)(l.i,{children:[Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[r[e],Object(R.jsx)(t,{width:re,height:ce})]}),"  "]})]})},e)}));return Object(R.jsxs)(l.r,{id:t,children:[Object(R.jsx)(F,{go:n,headerName:"Inventory",backButton:"base"}),c]})})),ae=Object(f.b)((function(e){return{friends:e.usersInfo.friends}}),{setActiveUserPage:C,go:q})((function(e){var t=e.id,n=e.go,r=e.friends,c=e.setActiveUserPage,i=r.map((function(e){return Object(R.jsx)(l.u,{onClick:function(t){return function(e,t){c(t),n(e)}(t,e.id)},"data-to":"pageView",before:Object(R.jsx)(l.c,{size:48,src:e.photo_200_orig}),caption:"offline",after:Object(R.jsx)("div",{children:Object(R.jsxs)("span",{style:{display:"flex",alignItems:"center",color:"black"},children:[700,Object(R.jsx)(B.a,{width:30,height:30})]})}),children:e.first_name+" "+e.last_name},e.id)}));return Object(R.jsxs)(l.r,{id:t,children:[Object(R.jsx)(F,{go:n,headerName:"Friends",backButton:"base"}),Object(R.jsx)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Your Friends"}),children:i})]})})),se=(n(148),Object(f.b)((function(e){return{}}),{go:q,changeInventory:T})((function(e){var t=e.changeInventory,n=e.go,r=e.id;return Object(R.jsxs)(l.r,{id:r,children:[Object(R.jsx)(F,{go:n,headerName:"Action Navigator",backButton:"base"}),Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Your actions"}),children:[Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:function(){t(h,-10)},children:"Building"})}),Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:n,"data-to":"attack",children:"Attack"})}),Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{stretched:!0,size:"l",onClick:n,"data-to":"defense",children:"Defense"})})]})]})}))),oe=function(e){var t=e.friends,n=e.go,r=e.setActiveUserPage,c=t.map((function(e){return Object(R.jsx)(l.u,{onClick:function(t){return function(e,t){r(t),n(e)}(t,e.id)},"data-to":"pageView",before:Object(R.jsx)(l.c,{size:48,src:e.photo_200_orig}),caption:"info",after:"700 \u20bd",children:e.first_name+" "+e.last_name},e.id)}));return Object(R.jsx)(l.k,{children:c})},ue=function(e){e.friends;return Object(R.jsx)(l.k,{})},de=Object(f.b)((function(e){return{friends:e.usersInfo.friends}}),{go:q,setActiveUserPage:C})((function(e){var t=e.go,n=e.id,c=e.friends,i=Object(r.useState)("friends"),a=Object(j.a)(i,2),s=a[0],o=a[1];return Object(R.jsxs)(l.r,{id:n,children:[Object(R.jsx)(F,{go:t,headerName:"Attack",backButton:"actionNavigator"}),Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Attack"}),children:[Object(R.jsxs)(l.z,{children:[Object(R.jsx)(l.A,{selected:"friends"===s,onClick:function(){o("friends")},children:"friends"}),Object(R.jsx)(l.A,{selected:"other"===s,onClick:function(){o("other")},children:"other"})]}),"friends"===s&&Object(R.jsx)(oe,{go:t,friends:c,setActiveUserPage:C}),"other"===s&&Object(R.jsx)(ue,{})]})]})})),je=function(e){return function(t){var n=t.id,r=t.go;return Object(R.jsxs)(l.r,{id:n,children:[Object(R.jsx)(F,{go:r,headerName:e.what,backButton:"inventory"}),Object(R.jsx)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"decription"}),children:Object(R.jsx)(l.i,{children:e.desc})})]})}},le="AUTH/SET_INIT_SUCCESS",fe="AUTH/SET_ACCESS_TOKEN",be={money:1e3,house:2,people:5,rocket:5,food:100},he={init:!1,accessToken:null};function Oe(){return(Oe=Object(d.a)(u.a.mark((function e(t,n){var r,c,i,a,s,o,j,l,f,b,h;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.user,c=t.name,i=t.time,a=t.repeat,t.consoleView,s=i,o=!0,j=null,l=0,(f=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.getServerTime().on("value",(function(e){var t=e.val()||0;j=Date.now()+t}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())(),b=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i,e.next=3,f();case 3:G.updateTimerDB(r.id,c,M,j),G.updateTimerDB(r.id,c,V,i),h();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(),s=i-l,t=setInterval((function(){(s-=1e3)<=0&&(n(),a?(l=0,clearInterval(t),b()):clearInterval(t))}),1e3);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o){e.next=11;break}return e.abrupt("return");case 11:return o=!1,e.next=14,G.getTimerDB(r.id).then((function(e){var t=e.val();if(t&&t[c])if(t[c].startTimer+t[c].timerTime<=j){if(n(),l=-(t[c].startTimer+t[c].timerTime-j),!a)return;for(;l>i;)n(),l-=i;b()}else l=i-(t[c].startTimer+t[c].timerTime-j),h();else b()}));case 14:return e.abrupt("return");case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pe=function(e,t){return Oe.apply(this,arguments)},ve=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,c,i,a,s,o,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.countRocket,r=t.userIdTarget,c=t.inventoryTarget,i=t.attackingUser,a=t.changeInventory,s=n,o=n,(d={}).Rocket=0,d.house=0,d.people=0,!(o<=0)){e.next=9;break}return e.abrupt("return");case 9:return a(v,-o),e.next=12,G.getUnseenInfo(r).then((function(e){var t=e.val();t&&Object.keys(t.defend).map((function(e){if(Number(e)==i)return d.Rocket+=Number(t.defend[i].attack),s+=Number(t.defend[i].attack),d.house+=t.defend[i].destroyed.house||0,void(d.people+=t.defend[i].destroyed.people||0)}))}));case 12:for(;c.Rocket>0&&o>0;)c.Rocket-=1,d.Rocket+=1,o-=1;for(;o>0;)c.house-=1,c.people-=4,d.house+=1,d.people+=4,o-=1;console.log(d),0==d.house&&delete d.house,0==d.people&&delete d.people,0==d.Rocket&&delete d.Rocket,G.updateFullUser(r,c),G.updateUnseenDefendInfo({userId:r,attackingUser:i,sendInfoDefend:d,rocketAttack:s});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=Object(f.b)((function(e){return{rocket:e.myInventory.rocket,activeUserPage:e.usersInfo.activeUserPage,friends:e.usersInfo.friends,user:e.usersInfo.user}}),{setActiveUserPage:C,changeInventory:T})((function(e){var t=e.activeUserPage,n=e.rocket,c=e.inventoryProfile,i=e.changeInventory,a=e.user,s=Object(r.useState)(1),o=Object(j.a)(s,2),u=o[0],d=o[1],f=function(e){d(e>n?n:Number(e))};return Object(R.jsx)(R.Fragment,{children:n>0?Object(R.jsxs)(l.k,{children:[Object(R.jsxs)(l.i,{children:[Object(R.jsx)(l.j,{children:Object(R.jsx)(l.o,{value:u,min:"0",max:n,type:"number",onChange:function(e){return f(e.target.value)}})}),Object(R.jsx)(l.j,{children:Object(R.jsx)(l.x,{min:0,step:1,max:n,value:u,onChange:function(e){return f(e)}})})]}),Object(R.jsx)(l.i,{children:Object(R.jsx)(l.d,{onClick:function(){ve({countRocket:u,userIdTarget:t,inventoryTarget:c,attackingUser:a.id,changeInventory:i})},mode:"commerce",size:"l",after:Object(R.jsx)(l.h,{children:u}),children:"Attack"})})]}):Object(R.jsx)("span",{children:'"You don\'t have rockets"'})})})),ge=Object(f.b)((function(e){return{activeUserPage:e.usersInfo.activeUserPage,friends:e.usersInfo.friends}}))((function(e){var t=e.go,n=e.backButton,r=e.headerName,c=e.money,i=e.friends,a=e.activeUserPage,s=i.find((function(e){return e.id===a}));return Object(R.jsxs)(R.Fragment,{children:[n?Object(R.jsx)(l.s,{left:Object(R.jsx)(l.t,{onClick:t,"data-to":n}),children:r}):Object(R.jsx)(l.s,{children:r}),s&&Object(R.jsx)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Profile"}),children:Object(R.jsx)(l.g,{before:s.photo_200_orig?Object(R.jsx)(l.c,{src:s.photo_200_orig}):null,description:s.city&&s.city.title?s.city.title:"",after:Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center",color:"black"},children:[c,Object(R.jsx)(B.a,{width:30,height:30})]}),children:"".concat(s.first_name," ").concat(s.last_name)})})]})})),me=n.p+"static/media/moneyBackground.7e4765dd.jpg",ye=n.p+"static/media/workerBackground.fb289e7f.jpg",ke=n(62),Ie=n.n(ke),Ee=function(e){e.go;var t=e.inventoryProfile,n=Object(r.useState)(Object(R.jsx)(l.v,{size:"large"})),c=Object(j.a)(n,2),i=(c[0],c[1],30),a=30,s={money:me,people:ye,house:null,roket:null,food:null},o=Object.keys(t).map((function(e){var n=ne[e];return Object(R.jsxs)(l.e,{className:Ie.a.card,children:[s[e]?Object(R.jsx)("img",{src:s[e],alt:"logo"}):null,Object(R.jsxs)("span",{children:[t[e],Object(R.jsx)(n,{width:i,height:a})]})]},e)}));return Object(R.jsx)(l.k,{children:Object(R.jsx)(l.f,{size:"s",children:o||Object(R.jsx)(l.v,{size:"large"})})})},Se=Object(f.b)((function(e){return{activeUserPage:e.usersInfo.activeUserPage}}),{go:q})((function(e){var t=e.id,n=e.go,c=e.activeUserPage,i=Object(r.useState)("check"),a=Object(j.a)(i,2),s=a[0],o=a[1],f=Object(r.useState)(be),b=Object(j.a)(f,2),h=b[0],O=b[1];return Object(r.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.getUserInventory(c).then((function(e){var t=e.val();null==t?(G.updateFullUser(c,be),O(be)):O(t)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(R.jsx)(l.r,{id:t,children:h?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(ge,{go:n,headerName:"Profile",backButton:"base",money:h.money}),Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Action"}),children:[Object(R.jsxs)(l.z,{children:[Object(R.jsx)(l.A,{selected:"check"===s,onClick:function(){o("check")},children:"check"}),Object(R.jsx)(l.A,{selected:"attack"===s,onClick:function(){o("attack")},children:"attack"})]}),"check"===s&&Object(R.jsx)(Ee,{inventoryProfile:h,go:n}),"attack"===s&&Object(R.jsx)(xe,{inventoryProfile:h})]})]}):Object(R.jsx)(l.v,{size:"large"})})})),Te=Object(f.b)((function(e){return{unseen:e.usersInfo.unseen,friends:e.usersInfo.friends,inventory:e.myInventory}}),{})((function(e){var t=e.id,n=e.unseen,r=e.friends;if(!n)return Object(R.jsx)(l.p,{id:t});var c=Object.keys(n.defend).map((function(e){var t,c=Number(n.defend[e].timeAttack),i=new Date(c).toLocaleString("en-GB",{timeZone:"UTC"}),a=Number(n.defend[e].attack),s=n.defend[e].destroyed,o=r.find((function(t){return t.id==e})),u=Object.keys(s).map((function(e){var t=ne[e];return Object(R.jsx)(l.m,{size:"s",header:Object(R.jsx)("div",{style:{textAlign:"center"},children:s[e]}),children:Object(R.jsx)(t,{width:25,height:25})},e)}));return Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"User info"}),children:[Object(R.jsx)(l.g,(t={before:(null===o||void 0===o?void 0:o.photo_200_orig)?Object(R.jsx)(l.c,{src:o.photo_200_orig}):null,description:o.city&&o.city.title?o.city.title:"",after:Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center",color:"black"},children:[a,Object(R.jsx)(ee.a,{width:20,height:20})]})},Object(z.a)(t,"description","\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u043d\u0430\u043f\u0430\u0434\u0435\u043d\u0438\u0435: "+i),Object(z.a)(t,"children","".concat(o.first_name," ").concat(o.last_name)),t)),Object(R.jsx)(l.l,{mode:"secondary",children:"Destroied"}),Object(R.jsx)(l.n,{children:Object(R.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:u})})]},e)}));return Object(R.jsx)(l.p,{id:t,header:"Defend info",children:c})})),we=function(e){e.friends;return Object(R.jsx)(l.k,{children:Object(R.jsx)(l.k,{children:"nothing"})})},Ue=function(e){e.friends;return Object(R.jsxs)(l.k,{children:[Object(R.jsx)(l.l,{mode:"secondary",children:"Settings"}),Object(R.jsx)(l.w,{disabled:!0,after:Object(R.jsx)(l.y,{defaultChecked:!0}),children:"Use rockets for defense"}),Object(R.jsx)(l.w,{disabled:!0,after:Object(R.jsx)(l.y,{}),children:"..."})]})},_e=Object(f.b)((function(e){return{friends:e.usersInfo.friends}}),{go:q})((function(e){var t=e.go,n=e.id,c=e.friends,i=Object(r.useState)("settings"),a=Object(j.a)(i,2),s=a[0],o=a[1];return Object(R.jsxs)(l.r,{id:n,children:[Object(R.jsx)(F,{go:t,headerName:"Defense",backButton:"actionNavigator"}),Object(R.jsxs)(l.k,{header:Object(R.jsx)(l.l,{mode:"secondary",children:"Defense"}),children:[Object(R.jsxs)(l.z,{children:[Object(R.jsx)(l.A,{selected:"settings"===s,onClick:function(){o("settings")},children:"settings"}),Object(R.jsx)(l.A,{selected:"history"===s,onClick:function(){o("history")},children:"history"})]}),"settings"===s&&Object(R.jsx)(Ue,{friends:c}),"history"===s&&Object(R.jsx)(we,{friends:c})]})]})})),Ae=7903112,Ne=Object(f.b)((function(e){return{inventory:e.myInventory,user:e.usersInfo.user,init:e.auth.init,activePanel:e.appPage.activePanel,activeModal:e.appPage.activeModal,unseen:e.usersInfo.unseen}}),{setDbInventory:function(e,t){return function(){var n=Object(d.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G.updateFullUser(e,(c={},Object(z.a)(c,"money",t.money),Object(z.a)(c,"rocket",t.rocket),Object(z.a)(c,"house",t.house),Object(z.a)(c,"people",t.people),Object(z.a)(c,"food",t.food),c));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},changeInventory:T,setFriends:function(e){return{type:U,friends:e}},setUser:function(e){return{type:_,user:e}},setInitSuccess:function(){return{type:le}},getDbInventory:function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G.getUserInventory(e).then((function(e){var t=e.val();t?(Object.keys(be).forEach((function(e){e in t==0&&(t[e]=be[e])})),n(w(t))):n(w(be))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setAccessToken:function(e){return{type:fe,token:e}},go:q,setInventory:w,modalGo:J,getBdUnseenInfo:function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G.getUnseenInfo(e).then((function(e){var t=e.val();if(!t)return console.log("\u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u043d\u0435\u0442"),void n(D(null));n(D(t)),t.defend&&n(J(K))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},listensFunc:function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(w(e.inventory)),n(D(e.unseenInfo||null)),e.unseenInfo&&n(J(K));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=Object(r.useState)(null),n=Object(j.a)(t,2),c=(n[0],n[1]),i=Object(r.useState)(Object(R.jsx)(l.v,{size:"large"})),a=Object(j.a)(i,2),o=a[0],f=a[1],b=Object(R.jsx)(l.q,{activeModal:e.activeModal,onClose:function(){e.modalGo(null,e.user.id)},children:Object(R.jsx)(Te,{id:K})});Object(r.useEffect)((function(){function t(){return(t=Object(d.a)(u.a.mark((function t(){var n,r,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.send("VKWebAppGetUserInfo");case 2:return n=t.sent,e.setUser(n),t.next=6,s.a.send("VKWebAppGetAuthToken",{app_id:Ae,scope:"friends,status"});case 6:return r=t.sent,e.setAccessToken(r.access_token),t.next=10,s.a.send("VKWebAppCallAPIMethod",{method:"friends.get",params:{fields:"nickname,photo_200_orig",v:"5.131",access_token:r.access_token}});case 10:return c=t.sent,e.setFriends(c.response.items),t.next=14,e.getDbInventory(n.id);case 14:return t.next=16,e.getBdUnseenInfo(n.id);case 16:e.setInitSuccess(),f(null);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}s.a.subscribe((function(e){var t=e.detail,n=t.type,r=t.data;if("VKWebAppUpdateConfig"===n){var c=document.createAttribute("scheme");c.value=r.scheme?r.scheme:"client_light",document.body.attributes.setNamedItem(c)}})),function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){function t(){return(t=Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(pe({name:"increaseMoney",time:2e4,user:e.user,repeat:!0},(function(){e.changeInventory(h,10)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.init&&(!function(){t.apply(this,arguments)}(),G.listenUpdateUser(e.user.id,e.listensFunc))}),[e.init]),Object(r.useEffect)((function(){e.init&&e.setDbInventory(e.user.id,e.inventory)}));var O={MoneyDesc:je({what:"Money",desc:"\u041f\u043b\u043e\u0442\u0438 \u043d\u043e\u043b\u043e\u0433\u0438"}),PeopleDesc:je({what:"People",desc:"\u0427\u0438\u0441\u0442\u043e \u0440\u0430\u0431\u044b (\u043d\u0435 \u0431\u0430\u043d\u044c \u0422\u0412\u0418\u0427)"}),HouseDesc:je({what:"House",desc:"\u041d\u0443\u0436\u043d\u043e \u0436\u0435 \u0433\u0434\u0435-\u0442\u043e \u0436\u0438\u0442\u044c"}),rocketDesc:je({what:"rocket",desc:"\u0411\u0410\u041c \u0411\u0423\u0425 \u0411\u0423\u0414\u0423\u041c"}),FoodDesc:je({what:"Food",desc:"\u0425\u0430\u0432\u0430\u0442\u044c \u0432\u043a\u0443\u0441\u043d\u043e"})},p=Object.keys(O).map((function(t){var n=O[t],r=String(t),c=r.charAt(0).toLowerCase()+r.slice(1);return Object(R.jsx)(n,{id:c,go:e.go},c)}));return Object(R.jsx)(l.a,{children:Object(R.jsx)(l.b,{children:Object(R.jsxs)(l.B,{activePanel:e.activePanel,popout:o,modal:b,children:[Object(R.jsx)(Z,{id:"home"}),Object(R.jsx)(Q,{id:"base"}),Object(R.jsx)(ie,{id:"inventory"}),Object(R.jsx)(ae,{id:"friends"}),Object(R.jsx)(se,{id:"actionNavigator"}),Object(R.jsx)(de,{id:"attack"}),Object(R.jsx)(_e,{id:"defense"}),Object(R.jsx)(Se,{id:"pageView"}),p]})})})})),Pe=n(41),Ce=n(63),De="TIME/SET_ENTRY",Be="TIMESET_OLD_ENTRY",Re="TIME/SET_TIMER",Fe={entry:null,oldEntry:null,timer:null,startTimer:null},ze=Object(Pe.b)({myInventory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(b.a)(Object(b.a)({},e),{},{money:e.money+t.change});case O:return Object(b.a)(Object(b.a)({},e),{},{house:e.house+t.change});case p:return Object(b.a)(Object(b.a)({},e),{},{people:e.people+t.change});case v:return Object(b.a)(Object(b.a)({},e),{},{rocket:e.rocket+t.change});case x:return Object(b.a)(Object(b.a)({},e),{},{food:e.food+t.change});case g:return t.setInventory;default:return e}},usersInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(b.a)(Object(b.a)({},e),{},{friends:t.friends});case _:return Object(b.a)(Object(b.a)({},e),{},{user:t.user});case A:return Object(b.a)(Object(b.a)({},e),{},{activeUserPage:t.id});case N:return Object(b.a)(Object(b.a)({},e),{},{unseen:t.info});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case le:return Object(b.a)(Object(b.a)({},e),{},{init:!0});case fe:return Object(b.a)(Object(b.a)({},e),{},{accessToken:t.token});default:return e}},time:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case De:return Object(b.a)(Object(b.a)({},e),{},{entry:t.time});case Be:return Object(b.a)(Object(b.a)({},e),{},{oldEntry:t.time});case Re:return Object(b.a)(Object(b.a)({},e),{},{timer:t.time});default:return e}},appPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return Object(b.a)(Object(b.a)({},e),{},{activePanel:t.active});case H:return Object(b.a)(Object(b.a)({},e),{},{activeModal:t.active});default:return e}}}),Me=Object(Pe.c)(ze,Object(Pe.a)(Ce.a)),Ve=n(40);n(170);s.a.send("VKWebAppInit"),Ve.a.initializeApp({apiKey:"AIzaSyAaCTI89WAScNMKK-5pzGmt5qcnF50U6aM",authDomain:"users-f9e77.firebaseapp.com",projectId:"users-f9e77",storageBucket:"users-f9e77.appspot.com",messagingSenderId:"730375624460",appId:"1:730375624460:web:e07c070bceaf98b8091b29",measurementId:"G-HR2BM8955Q"}),Ve.a.analytics();var Ge=t.default=Ve.a,Ye=function(e){i.a.render(Object(R.jsx)(f.a,{store:Me,children:Object(R.jsx)(Ne,{})}),document.getElementById("root"))};Ye(Me.getState()),Me.subscribe((function(){Me.getState();Ye()}))},62:function(e,t,n){e.exports={card:"PageView_card__32kXZ"}}},[[171,1,2]]]);
//# sourceMappingURL=main.82963f27.chunk.js.map